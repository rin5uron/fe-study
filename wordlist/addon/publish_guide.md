# Google Workspace Marketplace 公開ガイド

## 1. はじめに

このドキュメントは、個人用に作成したGoogle Apps Script製アドオンを、**Google Workspace Marketplace**で一般公開するための手順をまとめたものです。

個人利用と異なり、一般公開にはGoogleによる審査や、Google Cloud Platform (GCP) の設定など、多くのステップが必要となります。このガイドは、その全体像を把握するためのロードマップです。

**注意**: Marketplaceの要件や手順は頻繁に更新されます。必ず公式ドキュメントと合わせてご確認ください。

--- 

## 2. 公開までの4ステップ

### 【ステップ1: プロジェクトの準備】

アドオンを公開するには、まずApps ScriptプロジェクトをGoogle Cloudプロジェクトに紐付け、公開に必要な情報を設定します。

1.  **Google Cloud Platform (GCP) プロジェクトの紐付け**
    -   Apps Scriptエディタの左メニューにある「プロジェクトの設定」（歯車アイコン ⚙️）を開きます。
    -   「Google Cloud Platform（GCP）プロジェクト」の項目で、「プロジェクトを変更」をクリックし、表示される手順に従って新しい標準（Standard）プロジェクトを紐付けます。

2.  **OAuth同意画面の設定**
    -   GCPプロジェクトに移動し、`APIとサービス` > `OAuth同意画面` を開きます。
    -   `User Type`を「**外部**」に設定します。
    -   アプリ名、ユーザーサポートメール、デベロッパーの連絡先情報などを入力します。
    -   「スコープ」の画面では、スクリプトが要求する権限（今回はスプレッドシートとドキュメント）が自動で表示されるので、確認して保存します。

3.  **マニフェストファイルの編集**
    -   Apps Scriptエディタに戻り、「プロジェクトの設定」で「エディタで「appsscript.json」マニフェスト ファイルを表示する」にチェックを入れます。
    -   エディタに `appsscript.json` ファイルが表示されます。このファイルに、アドオンの名前やロゴのURL、サポートページのURLなどを追記します。

    ```json
    {
      "timeZone": "Asia/Tokyo",
      "dependencies": {},
      "exceptionLogging": "STACKDRIVER",
      "runtimeVersion": "V8",
      "addOns": {
        "common": {
          "name": "A-one単語カードメーカー",
          "logoUrl": "ここにロゴ画像のURLを記載",
          "supportUrl": "ここにサポートページのURLを記載"
        },
        "sheets": {}
      }
    }
    ```

### 【ステップ2: テストとデプロイ】

公開するアドオンのバージョンを確定させます。

1.  Apps Scriptエディタ右上の「デプロイ」>「新しいデプロイ」をクリックします。
2.  種類の選択で「アドオン」を選択します。
3.  説明を入力し、「デプロイ」をクリックします。ここで生成される**デプロイID**は後で使います。

### 【ステップ3: Marketplace SDKの設定】

ここが申請作業のメインステージです。GCPプロジェクト上で、Marketplaceに表示される情報を入力します。

1.  **Marketplace SDKの有効化**
    -   GCPプロジェクトの `APIとサービス` > `ライブラリ` で、「**Google Workspace Marketplace SDK**」を検索して有効化します。

2.  **アプリ構成**
    -   Marketplace SDKの設定画面を開き、以下の情報を入力します。
        -   **アプリの統合**: 「Google Workspaceアドオン」を選択し、ステップ2で取得した**デプロイID**を貼り付けます。
        -   **ストアの掲載情報**: アドオンの説明文、カテゴリ、言語などを設定します。
        -   **グラフィックアセット**: アドオンのアイコン（128x128, 32x32）、スクリーンショット（1280x800）、メインバナー画像（220x140）など、規定サイズの画像をアップロードします。**この準備が一番大変かもしれません。**
        -   **サポートリンク**: プライバシーポリシーや利用規約ページのURLを設定します。（公開には必須です）

### 【ステップ4: 審査と公開】

全ての準備が整ったら、いよいよGoogleに審査を申請します。

1.  **申請**
    -   Marketplace SDKの画面で、全ての必須項目を埋めると「送信」ボタンが押せるようになります。

2.  **Googleによる審査**
    -   **OAuthの検証**: スクリプトがユーザーデータ（スプレッドシートなど）にアクセスするため、Googleの信頼性・セキュリティチームによる審査が行われます。アプリの動作を説明する動画の提出を求められることもあります。
    -   **機能テスト**: アドオンが заявяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв- 機能が заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв заяв- 正常に動作するか、バグがないかなどがチェックされます。

3.  **公開**
    -   無事に審査を通過すると、ステータスが「公開」となり、数時間〜1日程度でGoogle Workspace Marketplaceにあなたのアドオンが掲載されます。

---

## 3. まとめ

アドオンの一般公開は、コードを書くこと以上に、**各種設定、画像やドキュメントの準備、そしてGoogleとのコミュニケーション**が重要になります。

まずは焦らず、ステップ1と2を完了させることを目標にしてみてください。

### **公式ドキュメント**
- **アドオンを公開する**: [https://developers.google.com/workspace/marketplace/how-to-publish](https://developers.google.com/workspace/marketplace/how-to-publish)
